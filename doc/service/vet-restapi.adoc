:includedir: ../..
:relrootdir: ../..
:restdocdir: {includedir}/lib/backend-data/build/generated-snippets
= Vet REST API

REST-API for managing veterinarians in the pet clinic application.
It provides standard CRUD operations and a search endpoint that returns items.

== Model

=== Vet

Each vet represents a veterinarian working at the pet clinic.
The `name` attribute is required and unique.
The `allSkill` collection is a list of strings and may be empty.
The `allSpecies` collection is a list of strings and may be empty.

The liquibase script defines the database table.

.Liquibase
[source,xml,options="nowrap"]
----
include::{includedir}/lib/backend-data/src/main/resources/liquibase/v1/vet.xml[]
include::{includedir}/lib/backend-data/src/main/resources/liquibase/v1/vet_skill.xml[]
include::{includedir}/lib/backend-data/src/main/resources/liquibase/v1/vet_species.xml[]
----

The entity class extends `JsonJpaEntity` which provides unique identifier and version for optimistic locking.

.Entity
[source,java,options="nowrap"]
----
include::{includedir}/lib/backend-api/src/main/java/esy/api/clinic/Vet.java[indent=0,tags=properties]
----

The item class is a simplified representation of a _Vet_ for item selection purposes.

.VetItem
[source,java,options="nowrap"]
----
include::{includedir}/lib/backend-api/src/main/java/esy/api/clinic/VetItem.java[indent=0,tags=properties]
----

== Operations

=== `POST /api/vet`

This operation creates a new _Vet_ entity.

****

.Command
include::{restdocdir}/post-api-vet/curl-request.adoc[]

.Request
include::{restdocdir}/post-api-vet/http-request.adoc[]

.Response
include::{restdocdir}/post-api-vet/response-body.adoc[]

****

This operation reports `Created` or code 201 if the entity was successfully created.

This operation reports `Bad Request` or code 400 if the data was not processed.

This operation reports `Conflict` or code 409 if a unique constraint would be violated.

=== `PUT /api/vet/{id}`

This operation updates an existing _Vet_ entity or creates a new one.

****

.Command
include::{restdocdir}/put-api-vet/curl-request.adoc[]

.Request
include::{restdocdir}/put-api-vet/http-request.adoc[]

.Response
include::{restdocdir}/put-api-vet/response-body.adoc[]

****

This operation reports `Ok` or code 200 if the entity was successfully updated.

This operation reports `Created` or code 201 if the entity was successfully created.

This operation reports `Bad Request` or code 400 if the data was not processed.

This operation reports `Conflict` or code 409 if a unique constraint would be violated or if data is outdated (invalid ETag).

=== `PATCH /api/vet/{id}`

This operation partially updates an existing _Vet_ entity.
You can update individual properties without affecting other properties.

==== `name` attribute

****

.Command
include::{restdocdir}/patch-api-vet-name/curl-request.adoc[]

.Request
include::{restdocdir}/patch-api-vet-name/http-request.adoc[]

.Response
include::{restdocdir}/patch-api-vet-name/response-body.adoc[]

****

This operation reports `Ok` or code 200 if the entity was successfully updated.

This operation reports `Not Found` or code 404 if the entity does not exist.

This operation reports `Bad Request` or code 400 if the data was not processed.

This operation reports `Conflict` or code 409 if a unique constraint would be violated or if data is outdated (invalid ETag).

TIP: The descriptions of attributes other than name are omitted for simplicity because they are following the same pattern.

==== `allSkill` collection

****

.Command
include::{restdocdir}/patch-api-vet-skill/curl-request.adoc[]

.Request
include::{restdocdir}/patch-api-vet-skill/http-request.adoc[]

.Response
include::{restdocdir}/patch-api-vet-skill/response-body.adoc[]

****

This operation reports `Ok` or code 200 if the entity was successfully updated.

This operation reports `Not Found` or code 404 if the entity does not exist.

This operation reports `Bad Request` or code 400 if the data was not processed.

This operation reports `Conflict` or code 409 if the entity is outdated (invalid ETag).

==== `allSpecies` collection

****

.Command
include::{restdocdir}/patch-api-vet-species/curl-request.adoc[]

.Request
include::{restdocdir}/patch-api-vet-species/http-request.adoc[]

.Response
include::{restdocdir}/patch-api-vet-species/response-body.adoc[]

****

This operation reports `Ok` or code 200 if the entity was successfully updated.

This operation reports `Not Found` or code 404 if the entity does not exist.

This operation reports `Bad Request` or code 400 if the data was not processed.

This operation reports `Conflict` or code 409 if the entity is outdated (invalid ETag).

=== `GET /api/vet`

This operation returns all persisted _Vet_ entities.

This operation supports advanced query parameters for filtering, e.g.

`?name=Max`::
Find vets with name containing "Max" (case-insensitive)
`?name=Max%`::
Find vets with name starting with "Max" (case-insensitive)
`?allSkill=surgery`::
Find vets with skills containing "surgery" (case-insensitive)

This operation supports sorting, e.g.

`?sort=name,asc`::
Sort vets by name in ascending order

This operation supports pagination, e.g.

`?size=10&page=1`::
Find 10 vets on page 1

****

.Command
include::{restdocdir}/get-api-vet/curl-request.adoc[]

.Request
include::{restdocdir}/get-api-vet/http-request.adoc[]

.Response
include::{restdocdir}/get-api-vet/response-body.adoc[]

****

This operation reports `Ok` or code 200 if the data was successfully loaded.

=== `GET /api/vet/search/findAllItem`

This operation returns all persisted _Vet_ entities as simplified _VetItem_ objects for selection purposes.
The items are sorted by name in ascending order.

This operation supports advanced query parameters for filtering.
See `GET /api/vet` for details.

This operation does not support sorting.
The result is always sorted by name in ascending order.

This operation does not support pagination.
It always returns the full filtered result set.

****

.Command
include::{restdocdir}/get-api-vet-item/curl-request.adoc[]

.Request
include::{restdocdir}/get-api-vet-item/http-request.adoc[]

.Response
include::{restdocdir}/get-api-vet-item/response-body.adoc[]

****

The following example shows a filtered request:

****

.Command
include::{restdocdir}/get-api-vet-item-filtered/curl-request.adoc[]

.Request
include::{restdocdir}/get-api-vet-item-filtered/http-request.adoc[]

.Response
include::{restdocdir}/get-api-vet-item-filtered/response-body.adoc[]

****

This operation reports `Ok` or code 200 if the data was successfully loaded.

=== `GET /api/vet/{id}`

This operation returns a single persisted _Vet_ entity.

****

.Command
include::{restdocdir}/get-api-vet-by-id/curl-request.adoc[]

.Request
include::{restdocdir}/get-api-vet-by-id/http-request.adoc[]

.Response
include::{restdocdir}/get-api-vet-by-id/response-body.adoc[]

****

This operation reports `Ok` or code 200 if the data was successfully loaded.

This operation reports `Not Found` or code 404 if the entity does not exist.

=== `DELETE /api/vet/{id}`

This operation deletes a single persisted _Vet_ entity.

****

.Command
include::{restdocdir}/delete-api-vet/curl-request.adoc[]

.Request
include::{restdocdir}/delete-api-vet/http-request.adoc[]

.Response
include::{restdocdir}/delete-api-vet/response-body.adoc[]

****

This operation reports `Ok` or code 200 if the entity was successfully deleted.

This operation reports `Not Found` or code 404 if the entity does not exist.
