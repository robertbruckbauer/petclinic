:includedir: ../..
:relrootdir: ../..
:graphqldir: {includedir}/lib/backend-data/src/main/resources/graphql
= Owner GraphQL API

NOTE: The GraphQL schema includes Pet and Vet types with corresponding controllers (PetGraphqlController, VetGraphqlController) and queries (allPet, petById, allVet, vetById, vetByName), but no documentation files exist for these APIs. Create PetGraphQL.adoc and VetGraphQL.adoc following the template structure from SpringGraphQL.adoc to complete the documentation set.

GraphQL API for querying pet owners in the pet clinic application.
It provides query operations to retrieve all owners, find owners by identifier or name, and navigate the owner-pet relationship.

== Schema

=== Owner

The main GraphQL type representing a pet owner who acts as a client in the pet clinic.

.Schema Definition
[source,graphql,options="nowrap"]
----
include::{graphqldir}/owner.gqls[]
----

The `Owner` type corresponds to the entity class defined in the backend API:

.Entity
[source,java,options="nowrap"]
----
include::{includedir}/lib/backend-api/src/main/java/esy/api/client/Owner.java[indent=0,tags=properties]
----

Each owner represents a pet clinic client who can own multiple pets.
The owner requires a valid name and address.
The contact field is optional.

NOTE: The Java entity marks `address` as @NotBlank (required), but the GraphQL schema shows it as nullable (`address: String`). Verify whether the schema should use `address: String!` to match the entity constraint.

The `allPet` field uses batch loading via `@BatchMapping` to efficiently load pets for multiple owners.
This optimization avoids N+1 query problems by collecting all owner IDs from the current batch, executing a single query (`findAllByOwnerIdIn`) to fetch all related pets, and then grouping them by owner for the GraphQL response.

NOTE: The Pet GraphQL schema (pet.gqls) is missing the `born` field (LocalDate) that exists in the Pet entity with @NotNull constraint. This is a significant data omission. Verify whether the schema should include: `born: LocalDate!` to expose the pet's birth date in GraphQL queries. Create PetGraphQL.adoc documentation to properly document the Pet type including all its fields and the custom LocalDate scalar.

== Queries

NOTE: According to the template, queries should be organized as: \"Collection queries\" (returning lists) first, then \"Object queries\" (returning single objects). Currently all queries are listed sequentially without this grouping. Consider restructuring: add a \"Collection queries\" subsection containing allOwner, then an \"Object queries\" subsection containing ownerById and ownerByName.

=== `allOwner`

This query returns all pet owners in the system.

.Query Definition
[source,graphql,options="nowrap"]
----
allOwner: [Owner]
----

*Returns:*

A list of all `Owner` objects.
Returns an empty list if no owners exist.

=== `ownerById`

This query returns a single owner by unique identifier.

.Query Definition
[source,graphql,options="nowrap"]
----
ownerById(id: ID): Owner
----

*Arguments:*

`id` (ID)::
The unique identifier of the owner (UUID format).

NOTE: The GraphQL schema shows `id` parameter without `!` (non-null marker), but the controller implementation uses `@NonNull`. Verify whether the parameter should be mandatory in the schema: `ownerById(id: ID!): Owner`

*Returns:*

An `Owner` object if found, or null if no owner exists with the given identifier.

=== `ownerByName`

This query returns a single owner by unique name.

.Query Definition
[source,graphql,options="nowrap"]
----
ownerByName(name: String): Owner
----

*Arguments:*

`name` (String)::
The unique name of the owner (exact match, case-sensitive).

NOTE: The GraphQL schema shows `name` parameter without `!` (non-null marker), but the controller implementation uses `@NonNull`. Verify whether the parameter should be mandatory in the schema: `ownerByName(name: String!): Owner`

*Returns:*

An `Owner` object if found, or null if no owner exists with the given name.
